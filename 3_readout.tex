
\section{Introduction}

Humans can flexibly attend to different aspects of the environment when their goals require it. This can be operationalized by asking human observers to report about one feature of a visual stimulus while ignoring other features. Such context-dependent judgments could be supported by a cortical implementation which increases sensitivity or selectivity for the sensory representations of reported features while suppressing others. A second and potentially complimentary implementation is to maintain stable sensory representations while flexibly changing the downstream readout of these. 

A great deal of evidence exists for the former possibility of changing representations to accommodate behavioral demands. Behavioral manipulations of spatial attention \citep{Klein2014-oe,Mitchell2009-do,Pestilli2011-gi,Womelsdorf2006-np}, feature-based attention \citep{Baldauf2014-uj,Harel2014-wd,Huk2000-uj,Jehee2011-mb,Serences2007-le,Cohen2013-uz,Treue1999-mp}, and stimulus expectations \citep{Kok2012-rh,Kok2013-km} all have been associated with changes in sensory representations. These changes may occur very early in the visual hierarchy \citep{Ling2015-fr} and take the form of changes in sensitivity \citep{Reynolds2000-mg,Serences2007-le,Snyder2018-yr,Treue1999-mp}, shifts in feature selectivity \citep{Cukur2013-gx,David2008-zx,Kastner1998-bi,Klein2014-oe,Spitzer1988-ib,Womelsdorf2006-np} (Reynolds et al., 1999; Womelsdorf et al., 2008), increases in baseline response \citep{Buracas2007-pe,Chen2012-ek,Kastner1999-qu,Ress2000-pa,Li2008-fe} Murray, 2008) useful for efficient selection \citep{Hara2014-tm,Pestilli2011-gi}, and changes in the structure of stimulus-driven and noise correlations (Cohen and Maunsell, 2011, 2009; Mitchell et al., 2009; Ruff and Cohen, 2016; Verhoef and Maunsell, 2017). 

However, flexible readout rather than change in sensory representation can be a behaviorally advantageous implementation of task demands. Although changing sensory representations can be beneficial, there cans be associated behavioral costs to suppressing ignored features in sensory representations \citep{Gazzaley2005-vd}  Mesgarani and Chang, 2012; Rees et al., 1997) when these are actually relevant to behavior. In many dramatic demonstrations (Haines, 1991; Mack and Rock, 1998; Neisser, 1979; Simons and Chabris, 1999) observers have been made blind to salient events when reporting about other aspects of a visual scene. This suggests a potential advantage to maintaining stable sensory representations and using flexible sensory readouts to enable adaptable behavior \citep{Bugatus2017-wl,Mante2013-tn,Peelen2009-us}.

Finding changes in sensory representations across different task conditions is not enough to demonstrate that these changes are large enough to explain perceptual behavior.  Instead, linking models are needed. Quantitative linking models (Barlow, 1972; Brindley, G. S., 1970; Cohen and Maunsell, 2010; Cook and Maunsell, 2002; Newsome et al., 1989; Pestilli et al., 2011; Teller, 1984) connect measurements of cortical activity to behavior by modeling the presumed process by which sensory activity gives rise to perceptual behavior. Such linking models are explicit hypotheses that can be falsified if they are unable to quantitatively link sensory representational changes to behavioral performance across different task conditions.

Here we used a linking model to study human reports of motion visibility and to understand whether sensory change or flexible readout implement this behavior. We first established that observers could independently report about either the contrast (luminance difference between dark and bright dots) or motion coherence (percentage of dots moving in a coherent direction) of random dot patches while ignoring the other feature. We then extended a well-established linking model of human contrast perception \citep{Boynton1999-jd,Foley1981-aw,Gardner2015-bd} (Ling and Carrasco, 2006; Nachmias and Sansbury, 1974; Pestilli et al., 2009) to account for behavioral performance during these tasks. Because in individual cortical areas the response to motion visibility is mixed, we allowed the model to weight retinotopic areas according to their sensitivity to the two features. The critical step to understand behavioral flexibility was to measure BOLD signal while observers performed each discrimination task. If sensory representations changed enough, then a linking model with a fixed readout of sensory areas should account for behavior (i.e. that used the same weighting of cortical responses for both tasks). Implementing such a fixed readout model showed that sensory changes alone were insufficient in magnitude to explain perception. Instead, in addition to the sensory change, a change in readout between different task conditions was necessary (i.e. a flexible readout). A benefit of flexible readouts is that sensory representations can retain information about the unattended feature. In line with this, we show that observers can re-map their reports unexpectedly. 

\section{Methods}

\subsection{Observers}
In total 29 observers were subjects for the experiments. All observers except one (who was an author) were naive to the intent of the experiments. Eight observers were excluded during initial training sessions due to inability to maintain appropriate fixation (see eye-tracking below). All of the remaining 21 observers (13 female, 8 male; mean age 28 y; age range 18-55) performed the motion visibility behavioral experiment outside of the scanner. Observers performed up to six one-hour sessions on separate days for an average of 2467 trials each (range 1167-3652, standard deviation 497). Ten of the observers (7 female, 3 male; mean age 26 y; age range 19-36) repeated the motion visibility experiment inside the scanner. Observers were scanned in two 90-minute sessions, each consisting of eight 7-minute runs, and a third one-hour scan which included retinotopy and anatomical images. Procedures were approved in advance by the Stanford Institutional Review Board on human participants research and all observers gave prior written informed consent. Observers wore corrective lenses to correct their vision to normal when necessary.

\subsection{Hardware setup for stimulus and task control}

Visual stimuli were generated using MATLAB (The Mathworks, Inc.) and MGL \citep{Gardner2018-uq}. During scanning, stimuli were displayed via an Eiki LC-WUL100L projector (resolution of 1920x1080, refresh-rate of 100 Hz) on an acrylic sheet mounted inside the scanner bore near the head coil. Visual stimuli were viewed through a mirror mounted on the head coil and responses were collected via an MRI-compatible button box. Outside the scanner, stimuli were displayed on a 22.5 inch VIEWPixx LCD display (resolution of 1900x1200, refresh-rate of 120 Hz) and responses collected via keyboard. Output luminance was measured for both the projector and the LCD display with a PR650 spectrometer (Photo Research, Inc.). The gamma table for each display was dynamically adjusted at the beginning of each trial to linearize the luminance display such that the full resolution of the 8-bit table could be used to display the maximum contrast needed. Other sources of light were minimized during behavior and scanning.

\subsection{Eye tracking}

Eye-tracking was performed using an infrared video-based eye-tracker at 500 Hz (Eyelink 1000; SR Research). Calibration was performed throughout each session to maintain a validation accuracy of less than 1 deg average offset from expected using either a ten-point or thirteen-point calibration procedure. Trials were canceled on-line when an observer’s eye position moved more than 1.5 deg away from the center of the fixation cross for more than 300 ms. During training and before data collection, observers were excluded from further participation if we were unable to calibrate the eye tracker to an error of less than 1 deg of visual angle or if their canceled trial rate did not drop to near zero. After training canceled trials consisted of fewer than 0.1\% of all trials. Due to technical limitations eye tracking was not performed inside the scanner. 

\subsection{Experimental design}

\subsubsection{Stimulus}

Motion stimuli consisted of two patches of random dot stimuli flanking a central fixation cross (1 x 1 deg). The random dot stimulus patches were rectangular regions extending from 3.5 to 12 deg horizontal and -7 to 7 deg vertical on either side of the fixation cross. Each patch was filled with 21 dots / deg2, 50\% brighter and 50\% darker than the gray background (300 cd / m2 in the scanner and 46 cd / m2 during behavior. All dots moved at 6 deg / s updated on each video frame. Motion strength was adjusted by changing motion coherence: the percentage of dots that moved in a common direction with all other dots moving in random directions. Dots were randomly reassigned on each video frame to be moving in the coherent or random directions. Both patches maintained a constant baseline in between trials of 25\% contrast and incoherent motion. To minimize involuntary eye movements, the coherent dot motion direction was randomized to be horizontally inward or outward from fixation on each trial, such that the two patches moved in opposite directions. 
\subsubsection{Contrast and coherence tasks}

Observers performed a two-alternative forced choice judgment about the visibility of the two dot patches (Fig. \ref{fig:c3f1}). At the start of each run observers were shown the word “contrast” or “motion” cueing them to report which side had the higher contrast or motion coherence, respectively. Each run began with a 5 s baseline period during behavioral measurements or 30 s during scanning (25\% contrast, 0\% coherence) to allow time for adaptation to occur. Trials consisted of a 0.5 s increment in either or both the contrast and motion coherence of the dot patches, a variable delay of 0.5 - 1 s, and a response period of 1s. The dot patches then returned to baseline for an inter-trial interval of 0.2 to 0.4 s randomly sampled from a uniform distribution (2 to 11 s, sampled from an exponential distribution during scanning). The base stimulus strength increments were chosen to be +7.5, +15, +30, and +60\% contrast above the baseline 25\% contrast and +15, +30, +45, and +60\% coherence above the baseline 0\% coherence. On every trial one dot patch was chosen as the target for contrast and incremented by an additional small delta, and the same was done independently for coherence. The target increment for the uncued feature was randomly chosen from [0.0, 1.8, 2.5, 3.5, 4.9, 6.9, 9.5, 13.3, 18.5\%] for contrast and [0.0, 5.0, 6.9, 9.6, 13.4, 18.6, 25.9, 36.1, 50.2\%] for coherence. The relevant target increment was chosen by a PEST staircase \citep{Taylor1967-yb} to maintain ~82\% correct on the cued task for each base strength (4 base strengths $\times$ 2 task conditions = 8 total staircases). Observers indicated with a button press which side contained the delta increment of the cued feature. An observer would be at chance performance if they reported on the wrong feature. Staircases were initialized on the first run (after training) at 25\% and 85\% for contrast and coherence, respectively. The staircases were maintained across sessions, but the step size was reset to one third the threshold every third run to allow for long-term fluctuation. Before data collection observers trained on the task until their performance at all base stimulus strengths was measurable (i.e. their threshold converged to less than 1 minus the base strength), on average one hour of training. Behavioral runs lasted four minutes and observers took breaks as needed. Observers performed up to 6 one-hour sessions of behavioral runs spanning multiple days.

On a subset of the motion visibility experiment runs (two of every five runs) observers were occasionally asked to report about the non-cued feature (trial probability 1/7, randomized). We refer to these as catch trials. Stimulus presentation occurred as normal on catch trials but after stimulus presentation and a fixed 0.5 s delay, a letter replaced the fixation cross to indicate that the observer needed to recall and respond about the un-cued feature. The length of the delay periods in both catch and regular trials (0.5 s and 0.5 - 1 s, respectively) were chosen to ensure observers could not rely on iconic memory to complete the task (Sperling, 1960) and to avoid observers getting into a rhythm and responding before the post-cue could appear. On contrast runs the post-cue letter was an “M” indicating that observers should recall about motion coherence and on coherence runs a “C” to indicate contrast. To improve our statistical power in estimating perceptual sensitivity during catch runs we used a single base stimulus increment: +30\% contrast and +40\% coherence. These base increments were used both for catch and regular trials on these runs.

\subsection{Behavioral data analysis}

To assess whether the perceptual data could be well characterized by a signal detection framework we tested the fit of cumulative normal distributions to the measured psychometric functions. We collapsed data from all observers across the four base stimulus strengths and separated trials in which observers discriminated contrast or coherence. We binned data according to the difference in stimulus strength for each task and computed the probability of making a rightward choice in each bin (filled circles, Figure \ref{fig:c3f2}a, b). We fit the binned data with a cumulative normal distribution (three parameters: the mean, $\mu$, standard deviation, $\sigma$, and a lapse rate, $\lambda$ which scaled the function so that it spanned the range $\frac{\lambda}{2}$ to $1-\frac{\lambda}{2}$) and evaluated the cross-validated fit on a held-out observer using the pseudo $r^2$:

\begin{equation}
    r_{pseudo}^2=1 - \frac{\log(\mathcal{L}_{model})}{\log(\mathcal{L}_{null})}
\end{equation}

where $L_{model}$ is the likelihood of the model given the data and $L_{null}$ is the likelihood of an intercept-only model.

\subsubsection{Just-noticeable difference (threshold) estimation}

To assess perceptual sensitivity we obtained just-noticeable differences (or thresholds) by fitting a Weibull function (Wichmann and Hill, 2001) to each observer’s data using maximum likelihood estimation:

\begin{equation}
    P_{correct}(x) = \gamma + (1 - \gamma - \lambda)(1 - e^{- [\frac{x}{\tau}]^{\beta}}
\end{equation}

Where $x$ is the difference in signal (either contrast or coherence) between dot patches, $\gamma$ is the guess rate, $\lambda$ is the lapse rate, $\beta$ controls the slope of the function, and $\tau$ the value of $x$ at which the function reaches 63\% of its maximum. For this two-alternative forced choice task the guess rate was 50\% while threshold (when $d^'=1$) corresponds to ~76\% correct. In total we fit twelve Weibull functions for each observer: eight for the contrast and coherence task (4 base strengths $\times$ 2 task conditions), two for the cued tasks in catch runs (1 base strength $\times$ 2 tasks), and two for the catch trials (1 base strength $\times$ 2 tasks).

\subsection{Cortical measurement during task performance}

We measured how contrast and coherence response functions changed in gain or offset compared to passive fixation in different retinotopically defined cortical visual areas as ten observers performed the contrast or the coherence discrimination task. Our general strategy was based on previous work \citep{Birman2018-sp} in which we have shown that the relationship between contrast or coherence and BOLD response can be independently parameterized with functional forms, as described below. The analysis proceeded in the following steps. We first used population receptive field measurements \citep{Dumoulin2008-uc} to determine the location of cortical visual areas in each individual subject. We then took the time series of data averaged across each visual area (for each hemisphere and subject) and performed an event-related analysis to compute the average response to the stimulus presented in the contralateral visual field for each of the 16 combinations of base contrast and coherence and 2 task conditions. We computed the amplitude of response by fitting these event-related responses to a canonical hemodynamic response measured during passive viewing. We had at least 42 measurements (21 repeats in 2 hemispheres) of each base stimulus combination for each task condition in each subject. Consistent with our overall conclusion of flexible readout, comparing these response magnitudes directly between conditions showed weak if any change between conditions. The 95\% confidence interval of the differences between tasks included zero for almost all conditions (amplitudes were higher during the contrast task compared the coherence task for 4/16 conditions, averaging over observers). This analysis does not separate out the independent effects of contrast and coherence across task conditions. So, to gain statistical power and to establish how these BOLD responses reflect difference in contrast and coherence response between task conditions, we used the response magnitudes to scale and shift by additive offset the contrast and coherence response functions, originally based on data from passive viewing. These 6 parameter fits (2 gain parameters and 1 offset parameter for each of the 2 task conditions) were based on ~672 (16 base contrast and coherence conditions x 42 repeats) trial measurements which provided sufficient statistical power and are reported in the main results. Note, for one subject the contrast and coherence values in the conditions differed: only 12 out of 16 conditions were run and with slightly different contrast and coherence values), we were still able to fit the population response function models to this smaller dataset. 

All BOLD imaging and data analysis procedures including imaging protocol, preprocessing, data registration across sessions, retinotopic definition of visual areas using population receptive field measurements, and extraction of mean time series from each visual area followed procedures described in detail in Birman and Gardner (2018). Briefly, visual area mapping and cortical measurements were obtained using a multiplexed sequence on a 3 Tesla GE Discovery MR750 (GE Medical Systems) with a Nova Medical 32ch head coil. Functional images were obtained using a whole-brain T2*-weighted two-dimensional gradient-echo acquisition (FOV = 220mm, TR = 500 ms, TE = 30 ms, flip angle = 46 deg, 7 slices at multiplex 8 = 56 total slices, 2.5 mm isotropic). In addition, two whole-brain high-resolution T1-weighted 3D BRAVO sequences were acquired (FOV=240mm, flip angle=12 deg, 0.9 mm isotropic) and averaged to form a canonical anatomical image which was used for segmentation, surface reconstruction, session-to-session alignment, and projection of data onto a flattened cortical surface. Preprocessing was performed using mrTools (Gardner et al., 2018) and included linear trend removal, high pass filtering (cutoff of 0.01Hz), and motion correction with a rigid body alignment using standard procedures (Gardner et al., 2008). Visual cortical areas V1-V4, V3A/B, V7 (IPS0), and MT (hMT+) were identified using the population receptive field method (Dumoulin and Wandell, 2008) and standard criteria (Wandell et al., 2007). Average time courses were obtained for each cortical visual area by averaging the top twenty-five task-responsive voxels per area. As documented in \citet{Birman2018-sp}, repeating the analysis using either all voxels, the top two voxels, or all voxels weighted by their population receptive field overlap with the stimulus results in a change in the signal-to-noise in the data, but did not change the relative sensitivities across cortical areas. 

To compute event-related responses we assumed that overlapping hemodynamic events sum linearly, an assumption that has been validated explicitly for visual responses \citep{Boynton1996-ff,Dale1997-ur}. We used a randomized inter-trial interval to avoid cognitive \citep{Zarahn1997-jc} and hemodynamic (Sirotin and Das, 2009) anticipatory effects and to increase the efficiency of our design \citep{Dale1999-oq,Liu2004-qy}. As violations of linearity have been noted with shorter inter-trial intervals, we chose a mean inter-trial interval of 6 s, sampled from an exponential with a range of 2 to 11 s, intended to minimize the overlap in the main positive lobe of the hemodynamic response between different events. Moreover, we used a balanced design in which each trial was equally likely to be followed by a trial with any of the other base stimulus strengths to minimize any systematic mis-estimation. We confirmed that the probability of each condition being followed by any other was roughly equal, i.e. $\chi^2(r,15)>0.05$, where $r$ was the test statistic computed by comparing the distribution of trial types following each individual trial type against a uniform distribution. No catch trials were run during scanning.

We computed event-related responses for each trial type using a finite-impulse response model \citep{Zarahn1997-jc} following standard procedures \citep{Gardner2005-pg}. We assumed each combination of different base strengths for contrast and coherence evoked a different hemodynamic response and responses that overlapped in time summed linearly. Because each visual stimulus was lateralized in one half of the visual field, we assumed that they evoked a response only in contralateral retinotopic areas. There were four base increments for contrast (+7.5, +15, +30, and +60\%) and four base increments for coherence (+15, +30, +45, and +60\%) which were independently manipulated, resulting in 32 total conditions (4 contrast $\times$ 4 coherences $\times$ 2 task conditions). To model these data, we used the following equation:

\begin{equation}
    y=X\beta + \epsilon
\end{equation}

Where y was an $n\times1$ column vector ($n$ = number of volumes) containing the measured hemodynamic response for one hemifield of one visual area in a single observer. $X$ was an $n\times (k\times c)$ stimulus convolution matrix ($c$ = number of conditions, $k$ = length in volumes of hemodynamic response to calculate), $\beta$ was a $(k\times c)\times 1$ column vector to be estimated, and $\epsilon$ the residual variance (assumed to be 0 mean Gaussian). Each block of $k$ columns in $X$ corresponded to one of the c conditions. These blocks contained a one in the first column at the starting volume of each occurrence of a trial of that condition and zeroes elsewhere. Each of the subsequent $k$ columns was then shifted downwards by one to form a Toeplitz matrix for that condition. In total $X$ had $n$ rows, equal to the length of the BOLD timeseries (for most observers n was 13,184), and 2592 columns (k=81 $\times$ c=32, where k was chosen to compute 40.5 s of response and the c conditions were the 4 contrast base strengths $\times$ 4 coherence base strengths $\times$ 2 tasks). By computing the least-squares estimate of the column vector $\beta$ we obtained the estimated event-related response to each condition accounting linearly for overlap in time. On every trial one dot patch was at a base strength and one had an additional increment. To equate difficulty throughout the task we allowed the additional increments to vary continuously via staircasing. To simplify the estimation problem and to improve statistical power we rounded the base + increment values to the nearest base strength. The choice of number of volumes of response k to compute did not change the result as long as it was sufficiently large to capture the full hemodynamic response. The Pearson’s correlation of the first 41 volumes between an analysis with k=41 (20.5 s of response) and k=81 (40.5 s of response) was r=0.97.  Because we randomized trial presentation, we assessed multicollinearity by checking that the stimulus convolution matrices (see below) were full rank and that the off-diagonal elements of the covariance matrix were small (less than 0.1\% of off-diagonal elements were larger than 10\% of the on-diagonal elements).

To obtain a response magnitude, we fit a scaled canonical hemodynamic response function measured during passive viewing to the event-related responses. We used a canonical hemodynamic response function that was measured in previous work when observers passively viewed the same stimulus \citep{Birman2018-sp}. This function took the form of a difference-of-gamma function whose maximum amplitude was set to one. We fit a single magnitude per condition which scaled this canonical function to minimize the sum of squared error between the event-related response and the scaled canonical function. For each condition (4 contrast base strengths $\times$ 4 coherence base strengths $\times$ 2 tasks) this gave us a scalar response amplitude for the evoked activity in each cortical area. 

The response magnitudes for each contrast, coherence, and task condition were next used to estimate how population response functions for contrast and coherence in different visual areas changed in gain and offset during task performance. In our previous work we parametrized the population response to contrast as a sigmoid function \citep{Albrecht1982-rq,Naka1966-fh}:

\begin{equation}
    R_{con}(s_{con}) = \alpha_{con}(\frac{s_{con}^{1.9}}{s_{con}^{1.6}+\sigma^{1.6}})
    \label{eqn:c4conresp}
\end{equation}

Where $\alpha$ was the maximum amplitude and $\sigma$ controlled the shape of the function. The exponents in the function were chosen according to previous work \citep{Boynton1999-jd}. The population response function to coherence was parameterized to be a saturating nonlinear function:

\begin{equation}
    R_{coh}(s_{coh})=\alpha_{coh}(1 - e^{\frac{s_{coh}}{\kappa})
    \label{eqn:c4cohresp}
\end{equation}

Where the parameter $\kappa$ controls the shape of the function by setting the point at which the exponential function reaches 63\% of its maximum and $\alpha_{coh}$  controls the amplitude. Large values of $\alpha_{coh}$ combined with large values of $\kappa$ make this function approach linear in the range [0 1] in which the stimulus strength $s_{coh}$ is bounded. Because $\alpha_{coh}$ and $\kappa$ are not interpretable on their own, we instead report the linear slope of the coherence response functions as a measure of sensitivity (see Birman and Gardner, 2018, for rationale). 

We fit the population response functions for each cortical area to the 32 measurements of response magnitude (4 base contrasts $\times$ 4 base coherences $\times$ 2 task conditions) during task performance:

\begin{equation}
    R_{area}(s_{con},s_{coh})=R_{area,con}(s_{con}+R_{area,coh}(s_{coh})+\alpha_{task}
    \label{eqn:c4r_area}
\end{equation}

We added the $\alpha_{task}$ parameter to fit additive offset while allowing the $\alpha_{con}$ (Eq. \ref{eqn:c4conresp}) and $\alpha_{coh}$ (Eq. \ref{eqn:c4cohresp}) parameters to change to fit multiplicative gain. The parameters for the response functions were initialized according to the passive viewing data in Birman and Gardner (2018) with the $\sigma$ and $\kappa$ parameters held constant such that response functions maintained their shape. For reference, the initial $\alpha_{con}$ parameter in V1 was 1.68, V2: 0.69, V3: 0.63, V4: 0.61, V3A: 0.35, V3B: 0.24, V7: 0.32, and MT: 0.22. The initial slope of the coherence response function in V1 was 0.07\% signal change / unit coherence, V2: 0.16, V3: 0.18, V4: 0.11, V3A: 0.25, V3B: 0.14, V7: 0.20, MT: 0.34. For each cortical area there were six free parameters (3 parameters $\times$ 2 task conditions) fit by minimizing the sum of squared error using the MATLAB function \textit{lsqnonlin}.   

\subsection{Linking model}

To link cortical responses to the perception of motion visibility, we modeled the decision process of an observer as a comparison of linearly weighted responses from retinotopically defined visual cortical areas subject to additive Gaussian noise. The model assumed the form of a probit regression in which the difference in weighted cortical responses for the two stimuli were passed through a probit function to make a trial-by-trial prediction of a choice for the stimulus on the right (Fig \ref{fig:c3f4}). The response to each visual stimulus for each cortical visual area was calculated from the parametric forms of population response functions for contrast and coherence, as defined above. When validating the model assumptions such as additive noise and lack of choice history terms, we used the parameters for the population response functions that were fit to passive viewing data (Birman and Gardner, 2018). To test whether fixed or flexible readouts were needed to explain task performance, we used parameters for the population response functions fit to BOLD data collected during task performance, as described above. The linking model parameters that were fit by maximum likelihood estimation to the behavioral data were the weights for each visual area (in different versions of the model we either fit all 8 visual areas or subsets of visual areas) and a bias term to account for any propensity to choose one side over the other. For the fixed readout there was one set of cortical weights for both tasks and for the flexible readout there were two sets of weights, one for each task. We describe in more detail the specifics of the model below.

We used the population response functions (Eq. \ref{eqn:c4conresp}, \ref{eqn:c4cohresp}) to simulate the trial-by-trial response of visual cortical areas to the stimulus in either hemifield (Eq. \ref{eqn:c4Rarea}). The parameters of the functions were either from the fit to passive viewing data or during task performance. Summing the response for contrast and coherence assumes that the responses to contrast and coherence are independent of each other, which we showed to be the case in Birman and Gardner (2018).

To obtain the `readout' of this representation from multiple cortical areas we proceeded by linearly weighting the area responses (Fig. \ref{fig:c3f4}). The full readout with all visual areas was computed with the following equation:

\begin{equation}
    R_{patch}(s_{con},s_{coh})=\beta_{V1}R_{V1}(s_{con},s_{coh})+\beta_{V2}R_{V2}(s_{con},s_{coh})+...+\beta_{MT}R_{MT}(s_{con},s_{coh})
    \label{eqn:c4r_patch}
\end{equation}

Where the response for each area on the right side of the equation is computed according to Eq \ref{eqn:c4r_area}.  Each $\beta$ was a free parameter which set the weight assigned to cortical areas in the readout process. We use the phrase fixed readout to refer to a model in which there are 8 cortical readout weights in total (one for each cortical area) shared across the two task conditions. Implicitly the fixed readout model therefore assumes that the measured cortical responses must differ between task conditions to accommodate changes in behavior. We use the phrase flexible readout when 16 weights were allowed, i.e. a separate weight for each task for each cortical area. In addition to the 8 cortical area models we also fit models in which we only used the response of areas V1 and MT, the most contrast and coherence sensitive human cortical areas, respectively \citep{Birman2018-sp}.

To compute the probability of an observer choosing the stimulus on the right we passed the difference in response to the two stimuli through a cumulative normal distribution \citep{Bliss1934-em}:

\begin{equation}
    \begin{aligned}
    P_{right}(s_{(con,left)},s_{(con,right)},s_{(coh,left)},s_{(coh,right)})= \\
    \Phi(R_{right}(s_{(con,right)},s_{(coh,right)})-R_{left}(s_{(con,left)},s_{(coh,left)})+\beta_{bias})
    \end{aligned}
    \label{eqn:c4eq8}
\end{equation}
	

Where $R_{right}$ and $R_{left}$ are the weighted cortical responses to the two stimuli on each trial, as calculated using Eq. \ref{eqn:c4r_patch}. $\beta_{bias}$ accounts for any bias to one side or another and $\Phi$ is the cumulative probability of a normal distribution with $\mu=0$ and $\sigma=1$. 

In the linking model, we allowed an additional parameter $\lambda$ to capture the observer's lapse rate, modifying Eq. \ref{eqn:c4eq8}: 

\begin{equation}
    P_{right}(s,...,\lambda)=\frac{\lambda}{2}+(1-\lambda)\Phi(R_{right}(s...)-R_{left}(s..)+\beta_{bias})
    \label{eqn:c4eq9}
\end{equation}	

We empirically estimated the lapse rate by finding the rate of observer errors on trials with a stimulus strength far above threshold \citep{Prins2012-ff}. Because we occasionally reset the step size in the staircases we were able to record a non-negligible number of trials with large stimulus increments, from these we selected trials in which the increment was at least 15\% for contrast or 40\% for coherence, which corresponded to increments of at least 2$\times$ threshold (15\% and 40\% also correspond to the maximum increment which could be shown at the highest base strength of contrast and coherence, respectively). Computed in this way $\lambda$ varied from 0 - 7\% (mean 3.0\%, 95\% CI [1.94, 4.56]).

We fit all variants of the linking model with maximum likelihood estimation using the active-set algorithm as implemented by the function fmincon in MATLAB. To avoid getting trapped in local minima we randomized the starting parameters and repeated the fitting procedure multiple times. 

We fit the linking model both within observers and across observers to test for generalization. Several observers were involved in both the experiments reported here as well those reported in \citet{Birman2018-sp} and so their linking models could be fit within-observer. To ensure generalization we also computed the average population response functions and used those to fit the linking model to the individual perceptual measurements from each of the 21 observers, including those who did not have within-subject measurements of cortical responses. For the population response functions estimated from passive viewing data the averaged-physiology and within-subject models had similar cross-validated log-likelihoods, $\log(\frac{\mathcal{L}_{average}}{\mathcal{L}_{within}})$= -2.22, 95\% CI [-8.18, 4.71]. This suggests that the population response functions were similar across subjects and that noise in the physiological measurements is reduced by averaging across observers.  For the measurements during task performance there was a large improvement from using averaged-physiology data, $\log(\frac{\mathcal{L}_{average}}{\mathcal{L}_{within}})$= 34.6, 95\% CI [-6.4, 185.4], presumably due to the lower signal-to-noise ratio in those data because the stimulus was limited to 0.5 s.

\subsubsection{Linking model variants}

To capture bias due to past choices \citep{Abrahamyan2016-od,Frund2016-ld} we tested models with additional stay/switch bias parameters. We added four additional parameters—two which absorbed bias after correct responses (usually found to be a bias toward the same side) and a second which absorbed bias after incorrect responses (usually found to be switching after errors). For clarity we show Eq. \ref{eqn:c4eq8} modified, but this model was still fit with the lapse rate (Eq. \ref{eqn:c4eq9}):

\begin{equation}
    \begin{aligned}
    P_{right}(s...)=\Phi(R_{right}(s_{con},s_{coh})-R_{left}(s_{con},s_{coh})+\beta_{bias}+\beta_{(left,correct)}C_{left}+ \\ \beta_{(right,correct)}C_{right}+\beta_{(left,incorrect)}I_{left}+\beta_{(right,incorrect)}I_{right}
    \end{aligned}
\end{equation}

Where $C$ and $I$ are binary variables set by whether the last trial was correct or incorrect, respectively, and had a response on the corresponding side (i.e. $C_{left}=1$ if the observer chose left on the last trial and was correct).  

We also fit an efficient selection variant of the linking model where responses are weighted according to their magnitude during active viewing \citep{Hara2014-mv,Pestilli2011-gi}. In this version of the model the responses in each cortical area were raised to an exponent $\rho$, multiplied by the cortical readout weights, and then the exponent root was taken before passing through the cumulative normal. The effect of this transformation is that an area which has a larger base response, through the exponential, will dominate the final signal. Again, for clarity we show this modification for Eq. \ref{eqn:c4eq8} but the full model included lapse rates (Eq. \ref{eqn:c4eq9}):

\begin{equation}
    P_{right}(s...)=\Phi(\sqrt[\rho]{R_{right}(s_{con},s_{coh})^{\rho}-R_{left}(s_{con},s_{coh})^{\rho}+\beta_{bias}})
\end{equation}

The linking model described so far makes the assumption that sensory noise limiting perception is additive, i.e. independent of stimulus strength, but we also tested a variation with noise that increased with response strength. If readout was limited by the variability of individual or small groups of correlated neurons, we might expect sensitivity to be subject to noise which increases with response. We tested this Poisson variant of the model by setting the variance (i.e. $\sigma^2$ in Eq. \ref{eqn:c4eq8}) of the noise to the average population response in the two dot patches, prior to being passed through the readout weights. Following the equations above this computation is done by averaging the response across areas for each dot patch:

\begin{equation}
    \sigma_{patch}^2=\frac{R_{V1}+R_{V2}+...+R_{MT}}{N}
\end{equation}

Where $N$ is the number of areas averaged and $R_{area}$ is computed using Eq. \ref{eqn:c4r_area}. We based the noise on the signal prior to readout under the assumption that Poisson noise would be generated by spiking variability occurring in the sensory system.

\subsection{Interpreting linking model parameters}

Using the fit model parameters, we were able to determine an estimate of the magnitude of noise limiting an observer’s perceptual sensitivity in units of BOLD percent signal change. Because we set $\sigma=1$ in the cumulative normal function of Eq. \ref{eqn:c4r_patch} we can estimate the noise in the sensory representation from the weight parameters. According to Eq. \ref{eqn:c4eq8}, a unit input difference between $R_{right}$ and $R_{left}$ will allow the observer to achieve threshold performance. It follows then that the $\beta$ weights (Eq. \ref{eqn:c4r_patch}) can be interpreted as scaling the raw BOLD responses such that a unit difference in weighted response gives rise to threshold performance. Assuming a standard signal-detection model where perceptual sensitivity ($d’$) is equal to the difference in responses divided by the standard deviation of the noise, a small $\beta$ weight would suggest a large amount of noise is limiting perception as it would take a very large difference in response to get threshold performance. Conversely a large $\beta$ weight would suggest the opposite, that only small differences in response are needed for threshold performance. More formally, if one considers just one area, such as V1: 

\begin{equation}
    \text{Threshold performance} (d'=1) = \frac{(R_{V1,right}-R_{V1,left})}{\sigma_{V1}} = \beta_{V1}(R_{V1,right}-R_{V1,left})
\end{equation}

Therefore, the $\beta$ weights are inversely proportional to the implied neural noise, $\sigma$, of the representation which limits perception.

To recover the model's just-noticeable differences (Fig. \ref{fig:c3f2}) we proceeded analytically. As described above, because we fit the additive noise model with the noise parameter $\sigma=1$ the population response functions, after scaling by the beta weights, are in units of standard deviations. To find the just-noticeable difference relative to a base stimulus strength we simply calculated the increment in signal needed to increase the readout response by one, equivalent to $d^'=1$. This is because when $\sigma=1$ we can reduce:

\begin{equation}
    d' = 1 = \frac{R(base+increment)-R(base)}{\sigma}
\end{equation}

to simply:
 
\begin{equation}
    R(base+increment)-R(base)=1
\end{equation}

\subsubsection{Model Comparison}

To compare the different variants of the linking model we used the cross-validated log-likelihood ratio and Tjur’s coefficient of discrimination \citep{Tjur2009-az}. Each variation of the linking model was fit in a 10-fold cross-validation procedure. 10\% of the data was reserved for validation while the remaining 90\% used to train. The log-likelihood was computed for each validation set and summed across all ten folds. To compare any two variations of the linking model we computed their likelihood ratio (i.e. the difference in total log-likelihood). The cross-validated log-likelihood ratio is similar in principle to measures of information criterion and sometimes referred to as the cross-validated information criterion \citep{McLachlan2000-bd}. When the difference in this statistic between two models is large, e.g. greater than 10 \citep{Burnham2004-za}, it indicates a substantial improvement in model fit. We use the cross-validated log-likelihood ratio rather than other information criterions (e.g. AIC, or BIC) because the cross-validation procedure already penalizes models with additional parameters for over-fitting. Although the cross-validated log-likelihood is useful for model comparison it is difficult to interpret its absolute magnitude in isolation. To help with interpretation we also report the cross-validated coefficient of discrimination CD. 

\begin{equation}
    CD=\mu_{right}-\mu_{left}
\end{equation}

Where $\mu_{right}$ is the model’s average predicted likelihood of a rightward choice for validation trials when the observer chose right and $\mu_{left}$ when the observer chose left. If the model predicts choices perfectly, then $\mu_{right}$ would be 1 and $\mu_{left}$ would be 0, giving a value for $CD$ of 1. If the model is at chance at predicting choices than $CD$ would be 0. $CD$ therefore indexes the difference between the centers of the trial-by-trial prediction distributions and although not a true measure of variance explained it shares many of the properties of $r^2$ and can be interpreted in a similar manner \citep{Tjur2009-az}.

\section{Results}

\subsection{Perceptual sensitivity to motion visibility}


\begin{figure}
\centering
\includegraphics[keepaspectratio,width=0.5\textwidth]{figs_c3/Fig1_behav.pdf}
\caption[Behavioral task]{Behavioral task. Observers discriminated which of two random dot stimulus patches had higher contrast or coherence in different blocks of trials. Each block began with the word “contrast” or “motion” indicating that observers should report about contrast or coherence, respectively, and ignore the other feature. Between trials (Inter-trial interval) and during all but the Stimulus segment, the dot patches were presented at 25\% contrast with incoherent motion. On each trial both dot patches increased by independent base increments of contrast and coherence (+7.5, +15, +30, or +60\% contrast +15, +30, +45, or +60\% coherence) for 0.5s (Stimulus). In addition, for each feature one side was chosen independently to have an additional threshold-level increment, determined by a staircasing procedure. For regular trials, after a 0.5 - 1s period (Delay), observers were asked to report which side contained the additional increment in contrast or coherence (Response) and were given feedback (Feedback). On a subset (Catch trials) of runs (2/5) on rare trials (1/7) the delay period was followed by a post-cue (Post-cue), the letter “M” or “C”, indicating that the observers should prepare a response about the un-cued feature. Additional time was given to observers to make these decisions (post-cue period of 1.5 s, response window of 2.5 s) and observers did not receive feedback on catch trials.}
\label{fig:c3f1}
\end{figure}

We characterized human perceptual sensitivity to the contrast and coherence of moving dots while observers had to report exclusively about one feature and ignore the other. We measured observers’ just-noticeable differences (JND) in image contrast or motion coherence between a pair of simultaneously presented random dot stimulus patches in a two-alternative forced choice task (Fig \ref{fig:c3f1}). Each block of trials began with either the word ``contrast'', indicating that observers should report which dot patch had higher contrast while ignoring differences in coherence, or ``motion'', indicating the opposite. Each trial consisted of a 0.5 s base increment in the contrast and coherence of both dot patches (at all other times the dot patches were kept visible at 25\% contrast and 0\% coherence). In addition to this base increment a small additional increment near perceptual threshold was added to one side independently for each feature. Therefore, for every trial regardless of cueing condition there was a difference in both features between the two dot patches and each patch was equally likely to contain the additional increment. After stimulus presentation and a brief delay, observers reported which side had the higher magnitude of the cued feature and received feedback.

\subsection{Observers were able to report about each motion visibility feature independently.}

\begin{figure}
\centering
\includegraphics[keepaspectratio,width=0.5\textwidth]{figs_c3/Fig2_behav.pdf}
\caption[Perceptual sensitivity to contrast and motion coherence and fit of validation linking model]{Perceptual sensitivity to contrast and motion coherence and fit of validation linking model. (a) Contrast task. The markers plot the average probability across observers and base stimulus strengths of indicating that the right dot patch had higher contrast or motion coherence while performing the contrast task, as a function of the difference in contrast (orange) or coherence (blue) between the two patches. Curves plot the predictions of the eight-area linking model using measurements made during passive viewing. These were fit to each individual observer’s behavioral data with a flexible readout, therefore fitting each task separately. (b) Coherence task, conventions same as (a). (c) Markers plot the just-noticeable difference for contrast during that task estimated from a Weibull function fit for each base stimulus strength, averaged across observers. Curves indicate the average prediction of the 8-area linking model across observers. (d) Same as (c) for the coherence task. All markers indicate the mean and error bars the 95\% confidence interval across observers. Curves indicate the mean model prediction across observers and shaded areas the 95\% confidence intervals. Some error bars are hidden by the markers.}
\label{fig:c3f2}
\end{figure}

Collapsing across observers and base stimulus strengths we found that observers were sensitive to the feature they were asked to report (dark orange, Fig. \ref{fig:c3f2}a, and dark purple, Fig. \ref{fig:c3f2}b), but insensitive to the features they were asked to ignore (light purple and light orange, Fig. \ref{fig:c3f2}a and \ref{fig:c3f2}b). The psychometric functions (circle markers in Fig. \ref{fig:c3f2}a) were well fit by cumulative normal distributions (not shown, average cross-validated $r_{pseudo}^2=87.7$\%). This suggests that observers’ decisions were consistent with a signal detection process in which two sensory representations were compared subject to Gaussian noise. Separating out sensitivity by base stimulus strength, we observed a proportional increase in just-noticeable differences (Fig. \ref{fig:c3f2}c-d) reminiscent of Weber's law. Weber’s law states that the slope of this relationship should be 1 on a log-log axis but we found slopes less than one for contrast, 0.44, 95\% CI [0.41 0.50], consistent with previous studies (Gorea and Sagi, 2001; Pelli, 1985; Pestilli et al., 2011), and 0.81, 95\% CI [0.78 0.85] for coherence. Fitting a Weibull function on a subject-by-subject basis for base contrasts 32.5, 40, 55 and 85\% we found just-noticeable differences in contrast (Fig. 2c) to be 4.6\%, 95\% CI [3.8, 5.5], 4.8\%, 95\% CI [3.9, 5.8], 5.5\%, 95\% CI [4.9, 6.2], and 7.5\%, 95\% CI [5.3, 9.8], respectively. For base coherences 15, 30, 45, and 60\% we found just-noticeable differences in coherence (Fig. 2D) to be 14.2\%, 95\% CI [12.9, 15.5], 17.7\%, 95\% CI [14.3, 21.1], 20.2\%, 95\% CI [15.1, 25.3], and 21.3\%, 95\% CI [16.7, 25.9], respectively. Note that for contrast the base stimulus strengths are reported as the absolute value and not the relative increment from the 25\% contrast and incoherent motion that was shown continuously throughout the experiment.

\subsection{Changes in cortical representation of motion visibility during task performance}

\begin{figure}
\centering
\includegraphics[keepaspectratio,width=0.5\textwidth]{figs_c3/Fig3_active.pdf}
\caption[Cortical measurements during active viewing]{Cortical measurements during active viewing. Observers performed the behavioral task while hemodynamic responses in retinotopic visual cortex were measured. (a) The average across observers of the $\alpha_{con}$ parameter, a measure of contrast sensitivity, is shown for each task context (dark and light markers are the contrast and coherence task, respectively). Inset shows how the change in the parameter affects the change in the contrast response function for V1, ignoring any change in additive offset. (b) As in (a) for coherence sensitivity as measured by the linear slope of the coherence response function (dark and light markers are coherence and contrast task, respectively) and inset shows the relationship for MT. (c) As in (a-b) for the $\alpha_{task}$ parameter which absorbs additive offsets. Inset shows the additive offset shift for MT.}
\label{fig:c3f3}
\end{figure}

We measured BOLD signal in retinotopically defined visual areas and found small changes in sensory responses when observers switched between reporting contrast and coherence (Fig. 3). Ten of the observers who performed the behavioral experiments repeated the task in the magnet. We used these measurements to examine how the contrast and coherence responses changed, either by multiplicative gain or additive offset, in each visual area (see Methods). For a majority of subjects, we found that when reporting about contrast, compared to reporting about coherence, the response to contrast in cortex showed a multiplicative gain (Fig. \ref{fig:c3f3}a). The average increase in $\alpha_{con}$ (Eq. \ref{eqn:c4conresp}) over areas and observers was 0.13\% signal change / unit contrast, 95\% CI [0.07, 0.19]. The direction of this effect wasn’t always consistent, in V1 8/10 observers showed an increase; for V2 6/10; V3 7/10; V4 7/10; V3a 7/10; V3b 7/10; V7 5/10; MT 6/10. For the coherence response, we found no consistent change in the slope of the response function when reporting about coherence \ref{fig:c3f3}b). The average over areas and observers was -0.02\% signal change / unit coherence, 95\% CI [-0.08, 0.04]), though some individual areas like MT showed an increase. These changes were inconsistent across observers, in V1 6/10 observers showed an increase in the linear slope of the coherence response; V2 6/10; V3 6/10; V4 6/10; V3a 4/10; V3b 5/10; V7 6/10; MT 6/10). In some linking models additive offsets have been shown to account for the perceptual benefits of selective attention \citep{Pestilli2011-gi}. We found that reporting about the stimuli, rather than passively viewing them, led to an additive offset in most visual areas (Fig. \ref{fig:c3f3}c). Average increase in $\alpha_{task}$ (Eq. \ref{eqn:c4Rarea}) over areas and observers compared to passive viewing was 0.36\% signal change, 95\% CI [0.30, 0.44]. Additive offsets were slightly larger during the contrast task than the coherence task (Fig. \ref{fig:c3f3}c). Averaged over areas and observers this effect was a modest 0.07\% signal change, 95\% CI [0.01, 0.14]. In summary, we measured small changes in sensory response between task conditions and found that in some cortical areas contrast sensitivity increases when subjects perform the contrast task and coherence sensitivity increases when subjects perform the coherence task. While these changes are in the right direction to underlie task performance, a formal linking model is required to determine if they are large enough to account for perceptual behavior.

\subsection{Linking model between cortical representation and perception of motion visibility}

\begin{figure}
\centering
\includegraphics[keepaspectratio,width=0.5\textwidth]{figs_c3/Fig4_linkingmodel.pdf}
\caption[Readout linking model]{Readout linking model. The linking model simulates the cortical response evoked by each dot patch according to an existing framework \citep{Birman2018-sp} which parameterized the contrast response function (orange curves) as a Naka-Rushton and the coherence response function (blue curves) as linear, or a saturating exponential function. The model weights the cortical responses from each visual area ($\beta$ values) evoked by the stimulus (Right or Left) according to the current task. The model then takes the difference between the signals evoked by each stimulus, plus a bias term ($\beta_{bias}$) to account for any individual observer’s bias to choose one response over the other. To convert from this weighted signal to probability of choosing the patch on the right, the signal is passed through a cumulative normal distribution (curve on right). The linking model is analogous to probit regression with nonlinear input signals.}
\label{fig:c3f4}
\end{figure}

We set out to build such a linking model (Fig. \ref{fig:c3f4}) that could quantitatively predict behavioral performance from measurements of cortical sensory representation. Once validated, such a model could then be used to assess whether the sensory changes we measured were large enough to explain behavioral performance in the task conditions. Linking models have been built for contrast discrimination tasks by assuming that higher contrast is detected by comparing the magnitude of cortical responses evoked by different stimuli, subject to some noise \citep{Boynton1999-jd,Foley1981-aw,Gardner2015-bd} (TODO: Ling and Carrasco, 2006; Nachmias and Sansbury, 1974; Pestilli et al., 2009). Behavioral sensitivity is determined by the ratio of response difference to the standard deviation of the noise, as in the classic signal detection measure d’. In our task, cortical responses are the result of stimuli that differ both in contrast and coherence. The linking model therefore needed to be able to differentiate which feature caused a difference in response. We reasoned that this could be accomplished by properly weighting visual areas with different sensitivity to each stimulus feature. Our model took the form of a probit regression \citep{Bliss1934-em} in which the difference in weighted response of visual areas to the two stimuli were computed and passed through the cumulative normal distribution to predict the probability of different choices (Fig. \ref{fig:c3f4}, see Methods: Linking model for full description).

Before evaluating such a model on the measurements of cortical activity during task performance (Fig. \ref{fig:c3f3}), we wanted to validate that such a linking model could in principle account for contrast and coherence discrimination. In previous work we published measurements of contrast and coherence response in cortex while observers passively viewed the same random dot stimuli used here \citep{Birman2018-sp}. These measurements were used to quantify the shape of contrast and coherence responses across retinotopically defined visual areas using functional forms (Naka-Rushton for contrast and a saturating exponential form for coherence, see Eq. 4 and 5). These passive-response data showed, for example, that V1-V4 are relatively more sensitive to changes in image contrast, whereas MT is more sensitive to changes in motion coherence. For reference, the parameters describing these differences in sensitivity are reported in the Methods (for additional details see: \citet{Birman2018-sp}). Using the functional forms measured during passive viewing we simulated the trial-by-trial response of eight visual cortical areas, V1-V3, V4 (hV4), V3A, V3B, V7, and MT (hMT+), and modeled sensory readout on each trial as a task-dependent linear weighting of the population responses (Fig. \ref{fig:c3f4}). This resulted in a scalar response for the left and right stimulus patches ($\Sigma_{right}$, $\Sigma_{left}$) on each trial. The observer’s decision about which side had the higher cued feature was modeled as a comparison between these two scalar responses ($\Sigma_{right}-\Sigma_{left}$) summed with a side bias ($\beta_{bias}$). This scalar decision variable was subject to Gaussian noise as implied by the cumulative normal of the probit link function. We fit the parameters of the linking model using maximum likelihood estimation for each observer (8 cortical area weights $\times$ 2 task conditions + 1 bias parameter = 17 total parameters) using the average population response functions from \citet{Birman2018-sp}. 

We found that the linking model based on the passive viewing BOLD data was a good fit for the behavioral measurements (curves, Fig. \ref{fig:c3f2}), capturing both the shape of the psychometric functions and the increase in just-noticeable differences with increasing base stimulus strength. To evaluate models we examined Tjur’s coefficient of determination ($CD$), a measure intended to be interpreted similarly to $r^2$ for models of binary decisions \citep{Tjur2009-az}. To compare models, we computed cross-validated log-likelihood ratios (see Methods: Model comparison). We found across observers an average $CD$ of 0.44, 95\% CI [0.42, 0.45] reflecting that the model captured the sensitivity of human observers to differences in visibility across both task conditions (curves, Fig. \ref{fig:c3f2}a-b) as well as the reduced sensitivity at increasing base stimulus strength (curves, Fig. \ref{fig:c3f2}c-d). The fits shown are for the 8-area model, but we also tested a model with only the two areas with the highest contrast and coherence sensitivity, V1 and MT (2 cortical area weights $\times$ 2 task conditions + 1 bias parameter = 5 total parameters). We found a similarly good fit, $\log(\frac{\mathcal{L}_{2}}{\mathcal{L}_{8}}})$ = 7.38, 95\% CI [-3.09, 32.78]. The average $CD$ of the 2-area model was also 0.44, 95\% CI [0.43, 0.45].

\begin{figure}
\centering
\includegraphics[keepaspectratio,width=0.5\textwidth]{figs_c3/Fig5_weights.pdf}
\caption[Cortical area weights]{Cortical area weights. (a) The weights of the flexible-readout model fit to passive viewing data are shown for the contrast task (x-axis) and coherence task (y-axis) for the eight cortical areas we defined retinotopically: V1, V2, V3, V4 (hV4), V3A, V3B, V7, and MT (hMT+). (b) As in (a) but for the 2-area model with only V1 and MT. All markers indicate the mean across observers and error bars the 95\% confidence intervals.}
\label{fig:c3f5}
\end{figure}

The linking model fit weights according to the relative sensitivity of each cortical area to contrast and coherence (Fig. \ref{fig:c3f5}). In the 8-area model the contrast task weights (x-axis, Fig. \ref{fig:c3f5}a) are proportional to how sensitive each area is to contrast relative to coherence: V1-V4 have positive weights, while only MT was given a negative weight. The negative weight on MT counteracts sensitivity to coherence in V1-V4 and ensures the linking model was insensitive to coherence when reading out contrast. The weights for the coherence task (y-axis, Fig. \ref{fig:c3f5}a) behaved similarly, with MT getting the largest positive weight and V1 a slight negative one. A similar pattern was observed for a model with only areas V1 and MT (Fig. \ref{fig:c3f5}b) but with less negative weighting in the coherence readout.  

\begin{figure}
\centering
\includegraphics[keepaspectratio,width=0.5\textwidth]{figs_c3/Fig6_poisson.pdf}
\caption[Poisson vs. additive noise]{Poisson vs. additive noise. (a,b) Same conventions as Fig \ref{fig:c3f2}a and b, except curves indicate the prediction of a model incorporating Poisson-like noise in which variance scales equal to response strength. (c) The cross-validated likelihood ratio (difference in log-likelihood) between the additive and Poisson models is shown for each observer. (d) The change in Tjur’s $CD$ comparing the additive models against the Poisson models, a measure analogous to $r^2$. Observers are sorted as in (c). In panels (c) and (d) evidence for the Poisson model is plotted towards the left and evidence for the additive model to the right.}
\label{fig:c3f6}
\end{figure}

Using model comparison, we validated our linking model assumptions that noise is additive and that observers had no dependency on choice history. Models based on single-unit variability often assume a Poisson-like noise (Softky and Koch, 1993), but because our model is based on population activity for which independent single-unit variable would be expected to average out, we modeled an additive noise component. This choice of additive Gaussian noise was important. A model using Poisson noise which increased with stimulus strength did not fit the data (Fig. \ref{fig:c3f6}). On average across observers the additive model was a better fit compared to the Poisson model, $\log(\frac{\mathcal{L}_{additive}}{\matchcal{L}_{Poisson}})$)= 43.58, 95\% CI [18.84, 77.93] (Fig. 6c) and improved CD by 0.01, 95\% CI [0.00, 0.02] (Fig. 6d). A number of studies have found that observers performing psychophysical tasks are biased by previous choices even when those choices are uninformative for the current trial \citep{Abrahamyan2016-od} (TODO: Frund et al., 2014). We also tested for possible biases due to choice history (see Methods) but found that including these additional fit parameters caused the cross-validated log-likelihood to deteriorate, suggesting over-fitting, $\log(\frac{\mathcal{L}_{original}}{\matchcal{L}_{stay/switch}})$= 3.66, 95\% CI [0.31, 9.08]. Thus, model comparison was able to validate that choice history effects were negligible, and that noise was best assumed to be additive rather than Poisson.

\subsection{Using the linking model to test fixed vs flexible readout}

\begin{figure}
\centering
\includegraphics[keepaspectratio,width=0.5\textwidth]{figs_c3/Fig7_readout.pdf}
\caption[Comparing fixed- and flexible-readout linking models]{Comparing fixed- and flexible-readout linking models. (a-c) Same conventions as Fig. \ref{fig:c3f2}a and b, except curves plot: (a) the fit of the passive BOLD measurements with a fixed readout, (b) the BOLD measurements during task performance with a fixed readout, and (c) the BOLD measurements during task performance with a flexible readout. The fixed-readout model forces any change in perceptual sensitivity to be the result of differences in sensory response between tasks by using only a single set of cortical readout weights (eight weights and one bias term). The flexible-readout model allows a different set of weights for each task condition (sixteen weights and one bias term). (d) Tjur’s $CD$ for the models in (a-c). Averages are shown as a bar on the axis. (e) Conventions as in (d) for the 2-area models with only V1 and MT. (f) Model comparison of the cross-validated likelihood ratio (difference in log-likelihood) between the task-response fixed-readout and task-response flexible-readout models. Evidence for the fixed-readout model is plotted to the left and flexible-readout to the right (none of the fits are in favor of the fixed readout model) (g) As in (f) for Tjur’s $CD$. Markers in panels a-c indicate the average across observers. Markers in panels d and e indicate individual observers. Error bars are the 95\% confidence intervals. Some error bars are hidden by the markers.}
\label{fig:c3f7}
\end{figure}

Having verified the linking model based on passive viewing data, we now asked whether the small changes in sensory representation which we measured during task performance could account for how perceptual sensitivity changed when observers switched task. If sensory changes were sufficiently large, then the readout could be fixed between task conditions. Such a fixed readout model would only require a single set of cortical area weights with changes in perception accounted for only by changes in sensory responses. 
As a baseline for comparison, we first fit the fixed-readout model on the sensory responses measured during passive viewing where by definition there are no sensory changes between task conditions. This passive-response fixed-readout model can only produce behavior that is intermediate between the two tasks. That is, it is sensitive to both contrast and coherence (Fig \ref{fig:c3f7}a, orange/yellow contrast curves and blue/purple coherence curves are not flat) and cannot switch sensitivity between the two tasks (Fig \ref{fig:c3f7}a, curves for left and right panels are identical).  The CD and likelihood of the passive-response fixed-readout model provide a lower bound on the possible explainable variance (Fig. \ref{fig:c3f7}d and e). 

Fitting the fixed-readout model to sensory responses measured during task performance showed that while changes in sensory response could account for a substantial amount of the behavioral performance, the changes were insufficiently large to fully explain task performance. This task-response fixed-readout model achieved a better fit of the behavioral data than the passive-response fixed-readout model (Fig. \ref{fig:c3f7}d and e, compare magenta and blue points) thus quantifying how much the sensory changes reported above can account for behavioral performance. Indeed, the task-response fixed-readout model was better able to capture differences in behavior between the contrast and coherence task (Fig \ref{fig:c3f7}b, compare curves for left and right columns). However, the linking model failed to completely capture the ability of subjects to change their perceptual sensitivity to contrast and coherence between the two tasks. In the contrast task, the contrast sensitivity curve (orange, Fig \ref{fig:c3f7}b) does not match the sensitivity of the observers and the model predicted a weak bias for coherence (light purple, left panel Fig \ref{fig:c3f7}b) that the subjects did not show. In the coherence task, the coherence performance was reasonably well-matched (purple curve, right panel), but the model predicted strong bias from contrast (orange curve).

Rather than rely only on changes in sensory representation between tasks, a linking model that could read out responses from visual areas differently between tasks was better able to fit the behavioral performance. We tested this task-response flexible-readout model by allowing the weights for different visual areas to change between tasks while still using the sensory responses measured during task performance. This model provided reasonable fits to the behavioral data (Fig. \ref{fig:c3f7}c), capturing the performance during the contrast task (left column), although it did predict more bias to contrast during the coherence task then the observers displayed (orange curve, right panel). Because the fixed-readout and flexible-readout models had different numbers of parameters (fixed-readout = 9 parameters, flexible-readout = 17) it was critical to evaluate the models with a cross-validated metric. We found that for the task-response measurements the flexible-readout model was a far better fit than the fixed-readout model (Fig. \ref{fig:c3f6}f and g), $\log(\frac{\mathcal{L}_{flexible}}{\matchcal{L}_{fixed}})$)= 60.16, 95\% CI [44.90, 77.75], difference in CD, 0.06, 95\% CI [0.04, 0.07]. Note that observers who we measured physiology for (black bars, Fig. \ref{fig:c3f7}f and g) show a larger improvement in model fit compared to the other observers, which we attribute to an effect of increased training.

Observers who we measured physiology for (black bars, Fig. 6C and D) show a larger improvement in model fit compared to the other observers (gray bars). One explanation for this effect is that the observers we measured in the scanner were better able to ignore the irrelevant feature due to having more practice. The fixed readout model, which predicts an inability to ignore the irrelevant feature, would then fail more dramatically for better-trained observers. Indeed, observers who were a part of the scanning were slightly better (n=11 observers, mean just-noticeable difference for contrast 5.62\%, 95\% CI [4.98, 6.50], and coherence 18.06\%, 95\% CI [16.32, 21.15]) compared to observers who did not participate in scanning (n=10, mean just-noticeable difference for contrast 10.02, 95\% CI [6.23, 19.95], and coherence 21.40\%, 95\% CI [18.64, 25.03]). 

As additive offsets have been used with a fixed readout to explain behavioral performance differences with spatial attention \citep{Pestilli2011-gi}, we also tested an efficient selection model that weights responses according to their magnitude, but found that this model also could not explain the behavioral performance. An increase in additive offset during one task condition or the other could be used by an efficient selection model that weighs signals by their magnitude \citep{Hara2014-mv,Pestilli2011-gi}, e.g. selecting out V1 during the contrast task and MT during the coherence task. On average response magnitudes did increase a moderate amount when observers performed the task compared to the passive viewing condition, but these additive offsets were similar for both tasks (Fig. \ref{fig:c3f5}C). We found that the flexible model was a far better explanation than an efficient selection model (see Methods for implementation details), $\log(\frac{\mathcal{L}_{flexible}}{\matchcal{L}_{selection}})$)= 130.39, 95\% CI [109.66, 151.31], difference in CD, 0.30, 95\% CI [0.28, 0.32]. 

\subsection{Behavioral evidence for a flexible readout}

One advantage to keeping sensory representations relatively stable is that observers can maintain information about unattended features. To measure whether observers could recall unattended information we included ‘catch’ trials in the behavioral task. In catch trials, observers were shown a post-cue after stimulus presentation which indicated that they should report about the un-cued feature (bottom time line, Fig. \ref{fig:c3f1}). Observers made these reports despite the stimulus having already been presented and despite having already had 0.5 s to prepare their response for the main task. We were able to ensure observers did not split their attention by keeping the main task at perceptual threshold, making catch trials rare, and not providing feedback.

Because observers were told at the start of each block (~65 trials or 4 minutes) whether or not catch trials would occur there is a concern that they could have split their attention, but we found no evidence for this. In other dual task settings there is a significant cost associated with performing two tasks at the same time (TODO: Sperling and Melchner, 1978), especially when one or both tasks are difficult (near perceptual threshold). Note that we designed the catch trials to minimize this effect by making them rare and not providing feedback. If observers split their attention, we would expect to detect an increased just-noticeable difference (JND) on the cued main task. Instead, we found that the just-noticeable differences were similar: on runs with catch trials the contrast task JND increased by only 0.19\% contrast, 95\% CI [-0.19, 0.78], and for the coherence task by 0.74\% coherence, 95\% CI [-0.76, 3.13].  

During catch trials we found that observers were less sensitive to the un-cued motion visibility features compared to when they were cued, but nevertheless they maintained significant information about the unattended features. Observers’ just-noticeable differences were larger on the catch trials both for the contrast task (average $\Delta$ just-noticeable difference = +5.30\% contrast, 95\% CI [+3.83, +7.22]) and coherence task ($\Delta$ just-noticeable difference = +45.84\%, 95\% CI [+26.17, +98.23]) (Fig. 7). These averages (and subsequent analysis) exclude 4/21 and 1/21 observers for the coherence and contrast tasks, respectively, because they could not perform the task and their just-noticeable differences were not measurable (i.e. their JND was more than what could be displayed on the screen). 

\begin{figure}
\centering
\includegraphics[keepaspectratio,width=0.5\textwidth]{figs_c3/Fig8_catch.pdf}
\caption[Perceptual sensitivity on catch trials]{Perceptual sensitivity on catch trials. Just-noticeable differences (JND) for contrast (left) and coherence (right) are shown for the regular (control, light colors) and catch (dark colors) trials during runs that included catch trials. Predicted just-noticeable differences for catch trials are shown for the fixed readout model (dashed lines). Markers indicate the average across observers and error bars the 95\% confidence intervals, some error bars are hidden by the markers. }
\label{fig:c3f8}
\end{figure}

If observers had a fixed readout which could not switch to the ignored feature during catch trials, then they would be forced to use the wrong readout and performance would be extremely poor. We found that this fixed readout model predicted much higher just-noticeable differences than measured and therefore could not account for catch trial behavior. That is, we used the task-response flexible-readout model to compute the expected JND on catch-trials assuming that observers were unable to switch the readout to the post-cued feature. For example, for the contrast-task in which the catch trials required making a coherence judgement, we used the cortical readout weights for the contrast-task ($\beta_{V1}$,$\beta_{V2}$,...), and vice-versa. This model underestimated human performance on catch trials (dashed lines, Fig. \ref{fig:c3f8}). On contrast catch trials (i.e. post-cued trials when observers reported about contrast, during a run where the main task was coherence) the model predicted just-noticeable differences of 56.9\%, 95\% CI [33.8, 80.1], but the average observer had a JND of only 10.1\% contrast, 95\% CI [7.5, 12.7]. On coherence catch trials the model predicted that observers would be incapable of performing the task but the average observer JND was 40.8\% coherence, 95\% CI [32.4, 49.2]. 

Instead, we found that a better explanation for catch trial behavior came from a readout which could dynamically change within trials but incurred an additional cost for maintaining sensory information in working memory. This cost could be due to a drop in the signal-to-noise of the sensory representation, perhaps due to responses degrading over time. We estimated the cost by dividing the thresholds measured during catch trials by the thresholds measured during regular trials. This approach suggests that on average $\sigma$ increased (or responses degraded) for coherence by a factor of 3.44, 95\% CI [2.46, 5.90] and for contrast by 2.21, 95\% CI [1.87, 2.66]. The overlap in estimates suggests a single cost, i.e. the change from a discrimination task to a working memory task, might govern the change in performance for both tasks; averaging the increase in noise gives an estimated reduction in sensitivity of 2.83, 95\% CI [2.31, 4.17]. Thus, a model which allows rapid re-weighting, combined with a fixed cost for using working memory, can explain behavioral performance for both contrast and coherence catch trials.

\section{Discussion}

We found that observers were able to independently judge the visibility of patches of moving dots based on either their contrast or coherence. Concurrent measurements of BOLD activity showed that there were small changes in sensory representations during task performance. Cortical responses were somewhat more sensitive to contrast during contrast discrimination and, in some areas like MT, more sensitive to coherence during the coherence task. Our analysis with a fixed-readout linking model showed that these changes could account for some, but not all of the behavioral performance. Instead, the behavior was consistent with a flexible readout of sensory representations. Keeping representations relatively stable should allow observers to retain information about unattended features and we found that during catch-trials this was the case. Our results highlight the importance of using models that quantify the link between cortical representation and perception.

\subsection{Linking models for human motion visibility perception}

We manipulated the contrast and coherence of random dot motion stimuli because of the extensive existing knowledge of how neural representations of these features are related to  visual perception \citep{Gold2007-ys} and because their similar representation in cortex suggests that changing the representation of one will necessarily affect the other. Contrast, the average difference between bright and dark \citep{Bex2002-it}, and coherence, the percentage of dots moving in the same direction, both control the visibility of motion. Human cortical visual areas are known to be sensitive to these properties such that an increase in visibility results in monotonically increasing responses throughout visual cortex \citep{Avidan2002-jg,Birman2018-sp,Britten1993-oh,Gardner2005-pg,Logothetis2001-kk,Olman2004-dd,Boynton1996-ff,Olman2004-dd,Rees2000-ul,Tootell1998-bb,Simoncelli1998-ts}. For observers to judge these two features independently their sensory representations need to be separated according to context, a step which existing linking models built for single features have not had to contend with.

The computational steps from sensory representation to perception have been well characterized for contrast discrimination. In these linking models an observer’s choice is computed by comparing the evoked neuronal responses to different stimuli \citep{Boynton1999-jd,Foley1981-aw} (TODO: Ling and Carrasco, 2006; Nachmias and Sansbury, 1974; Pestilli et al., 2009). Individual neurons exhibit monotonically increasing responses to contrast \citep{Albrecht1982-rq}, with different parameterizations \citep{Tolhurst1983-cv} that can be pooled into a population response \citep{Shadlen1996-pr}. Such population responses to contrast are well-indexed by BOLD signal in human visual cortex \citep{Avidan2002-jg,Boynton1996-ff,Boynton1999-jd,Gardner2005-pg,Heeger2000-pq,Logothetis2001-kk}. Linking models have been shown to account for BOLD signal measurements and perceptual responses during contrast discrimination tasks \citep{Boynton1999-jd}, predict changes in these measures during surround masking \citep{Zenger-Landolt2003-kq} and detection \citep{Ress2000-pa}, and have been used to describe the selection of signals from attended locations \citep{Hara2014-mv,Pestilli2011-gi}. 

Our model extends a linking model of contrast discrimination \citep{Boynton1999-jd} to simultaneous judgments of contrast and coherence. To separate the intertwined sensory representations of these features we allowed a linear weighting of cortical areas. The weights fit by the model confirmed that the bulk of information for these simple perceptual decisions was available in V1 for contrast perception and MT for coherence. This matches with previous results implicating monkey MT in judgments about motion \citep{Britten1996-ik,Katz2016-xc,Newsome1988-os}. But the weights also revealed that other areas could play an important role in perception by suppressing correlated signals about un-cued features in the readout. Our linking model is also specific to the random dot stimulus we chose. Changing the dot density \citep{Smith2006-cb} or aperture size \citep{Ajina2015-xm,Becker2008-uj,Costagli2014-kg} can result in decrements or zero response to increasing coherence, which would necessitate a linking model specific to those stimulus properties. We chose our stimulus size, dot density, and dot speed with these concerns in mind (for additional discussion of how stimulus properties affect the coherence response see \citet{Birman2018-sp}.  

The linking model we developed held only if sensory noise was modeled as additive but not if variability increased in proportion with firing rate \citep{Softky1993-ki}. Additive noise appears repeatedly in the literature using linking models \citep{Boynton1999-jd,Hara2014-mv,Pestilli2011-gi,Sapir2005-ri}, in purely psychophysical approaches \citep{Gorea2001-yt} (TODO: Neri, 2018, 2010), and in measurements of population activity from voltage sensitive dyes (Chen et al., 2006). In our results, the Poisson noise model failed because it combined increasing noise with response functions that saturate \citep{Birman2018-sp}; either of which alone predicts the cumulative normal form of the psychometric functions and a Weber-law like effect at increasing base stimulus strengths. This result suggests that the noise that limits perceptual behavior is not the individual variability in firing rate of single neurons, which presumably is averaged out across a population, but a correlated source of variability which is not dependent on response amplitude.

\subsection{Flexible readout of sensory representations}

Our results demonstrate that sensory change due to attention does not transform the sensory representation directly into a form that can be used to drive motor responses. Instead, switching from reporting one stimulus property to another must change the readout (i.e. weighting of connections), which may begin to occur in sensory cortices (TODO: Ruff and Cohen, 2017) but must also extend beyond them. One possible role for the response gain is that it works together with changes in readout, acting, as we calculated, as a weak form of sensory enhancement. Recent theoretical and experimental results suggest that such changes might improve the ability of a linear readout to differentiate between stimulus-driven and internal signals \citep{Ecker2016-ro,Rabinowitz2015-uz,Snyder2018-yr}. These changes match with our finding that noise limiting perceptual sensitivity is due to correlated internal variability. Sensory changes might also drive responses to be more aligned with the readout dimension (TODO: Ruff and Cohen, 2019), effectively working together.  

Although for our task the scale of sensory changes provided only a partial explanation for context-dependent behavioral reports, this need not always be the case. In the literature on visual attention there are many examples of changes in sensory representation as a result of task demands \citep{Carrasco2011-xp}. We interpret these results and our own as falling within a continuum where task demands are implemented by complementary changes in sensory representation and sensory readout. Sensory effects that can alone account for behavioral changes would be at one end of this continuum. For example, measurements of changes in spatial tuning \citep{Kay2015-pd,Klein2014-oe,Vo2017-oi} may underlie bottom-up biases in spatial perception \citep{Klein2016-ox}, additive shifts in response \citep{Buracas2007-pe,Li2008-fe,Murray2008-xj} can be used by efficient selection mechanisms \citep{Chen2012-fu,Hara2014-mv,Pestilli2011-gi} to account for perceptual threshold enhancement, and changes in correlation structure during focal spatial attention \citep{Mitchell2009-do} can be sufficient to explain changes in perceptual sensitivity \citep{Cohen2010-xs,Cohen2009-bt} (TODO: Ruff and Cohen, 2019). These spatial attentional effects may reflect the combination of a fixed sensory readout combined with changes in representation which select \citep{Carrasco2011-xp} and align \citep{Ruff2018-yx} relevant signals while suppressing others.

Our results suggest that judgments of motion visibility rely on both a context-dependent readout and changes in sensory representation, putting our task in a different part of the continuum described above. Relying on flexible readout could help maintain adaptability in the face of uncertain task demands. It is possible that given enough time and task-consistency observers could have shifted their cortical implementation to solve our task using a fixed readout. This could be done by learning to pre-select relevant sensory representations, saving computational cost and speeding decision making. Similarly, sensory representations may be kept stable for visual features that are relevant for a variety of behaviors. For example, scene gist is known to survive inattention, both perceptually \citep{Li2002-ji} and as information that can be decoded from BOLD signal measurements of visual cortex \citep{Peelen2009-us}. 
How the human brain implements task demands may depend not only on the form of sensory representation, the precise task demands, and the extent of learning, but also on the associated computational costs \citep{Gardner2019-ky}. Flexible readout might be implemented by parts of prefrontal cortex which re-represent visual information in a context-dependent manner \citep{Bugatus2017-wl}, using dynamical properties that can selectively integrate different features of sensory stimuli \citep{Mante2013-tn}. Engaging these mechanisms requires resources to represent and process aspects of sensory stimuli that may not be behaviorally relevant. Changing sensory representations and using a fixed readout may instead reflect a computationally efficient solution where the visual system no longer has to contend with representing irrelevant stimulus information. In general, the complimentary mechanics of sensory change and change in readout are both essential tools for the human brain, allowing us to meet the demands imposed by daily life where constant shifts in attention are necessary to achieve our goals.
