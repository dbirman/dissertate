%% raw data
unatt = [0, 20.27070113884257
13.061313360041801, 15.800632045188735
28.115808594819207, 22.335216197609498
43.889193022619246, 39.07260225114256
58.330056983601644, 48.02597855027744
73.82947221738371, 57.24474747223397
89.21131211585833, 52.36492729821417
105.02239530196331, 48.28948001426662
119.86749446338365, 29.71514834813911
134.82568989971878, 24.70231666956974
150.23552392564758, 23.179303423163375
165.8711772463732, 23.401199392838464
179.99888023490183, 20.136428861738025];

att = [0.05598825490829995, 26.98431499406938
12.841092890735816, 14.72708421462994
28.551770473038538, 23.945222750308957
43.311394231965544, 45.78810726520184
58.257645507253564, 64.67637129751742
73.71115037201082, 68.38997685818796
89.5916589942021, 72.63941075472167
104.63122402767061, 52.05036454574861
120.31465399258462, 32.667877671883936
135.89207952820558, 25.90761523212315
151.30303331923253, 24.5188742628213
165.67111254883415, 24.744552550161316
180.6886555353721, 26.848151558132386];

x = unatt(:,1);
y = unatt(:,2);
y = y ./ sum(y);
ufit = fitVonMises(x,y,90);

x = att(:,1);
y = att(:,2);
y = y ./ sum(y);
afit = fitVonMises(x,y,90);

%% figure
cmap = colorblindmap/255;
h = figure(1); clf; hold on
plot(ufit.xSmooth,ufit.yFitSmooth*sum(unatt(:,2)),'-','Color',cmap(1,:));
p1 = plot(unatt(:,1),unatt(:,2),'o','MarkerFaceColor',cmap(1,:),'MarkerEdgeColor','w','MarkerSize',10);

plot(ufit.xSmooth,ufit.yFitSmooth*sum(unatt(:,2))*1.35-7,'-','Color',cmap(7,:));
% plot(ufit.xSmooth,ufit.yFitSmooth*sum(att(:,2)),'-','Color',cmap(7,:));
p2 = plot(att(:,1),att(:,2),'o','MarkerFaceColor',cmap(7,:),'MarkerEdgeColor','w','MarkerSize',10);

axis([0 180 0 76]);

legend([p1 p2],{'Unattended','Attended'});

set(gca,'XTick',0:20:180);
set(gca,'YTick',[0 76]);

xlabel('Orientation');
ylabel('Response (spikes / s)');

drawPublishAxis('figSize=[20,15]','poster=1');

savepdf(h,fullfile('~/proj/dissertate/defense/mcadams1999_fig2_unedited.pdf'));